tkit-quarkus-example-jpa-db:
  container_name: tkit-quarkus-example-jpa-db
  image: postgres:10.5
  environment:
    POSTGRES_DB: "db"
    POSTGRES_USER: "db"
    POSTGRES_PASSWORD: "db"
  labels:
    - "test.priority=90"
    - "test.Wait.forLogMessage.regex=.*database system is ready to accept connections.*\\s"
    - "test.Wait.forLogMessage.times=2"
    - "test.log=true"
    - "test.property.quarkus.datasource.jdbc.url=jdbc:postgresql://$${host:tkit-quarkus-example-jpa-db}:$${port:tkit-quarkus-example-jpa-db:5432}/db?sslmode=disable"
  ports:
    - "5432:5432"
  networks:
    - test

tkit-quarkus-example-jpa:
  container_name: tkit-quarkus-example-jpa
  image: tkit-quarkus-example-jpa:latest
  ports:
    - "8080:8080"
  labels:
    - "test.unit=false"
    - "test.priority=200"
    - "test.image.pull=DEFAULT"
    - "test.Wait.forLogMessage.regex=.*Installed features:.*"
    - "test.Wait.forLogMessage.times=1"
    - "test.log=true"
    - "test.env.EMAILSERVERURL=http://mocking-server:8080"
    - "test.env.QUARKUS_DATASOURCE_JDBC_URL=jdbc:postgresql://tkit-quarkus-example-jpa-db:5432/db?sslmode=disable"
  networks:
    - test